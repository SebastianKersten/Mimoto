{% extends "MimotoCMS/components/base.twig" %}

{% block content %}

    {% set extends = Aimless.data('extends.name') %}
    {# set extends_id = Aimless.meta('extends.id') #}{# todo #}
    {% set extends_id = Aimless.meta('id') %}{# todo #}


    <div class="MimotoCMS_pages_entities_EntityDetail__meta">

        <div class="MimotoCMS_pages_entities_EntityDetail__meta_info">

            Name = <b><span {{ Aimless.realtime('name')|raw }}>{{ Aimless.data('name') }}</span></b>

            {% if entityStructure.extends is not empty %}
                {% for extension in entityStructure.extends %}
                    extends <b><a href="/mimoto.cms/entity/{{ extension.id }}/view"><span mls_id="entity.{{ extension.id }}.name">{{ extension.name }}</span></a></b>
                {% endfor %}
                <br>
            {% endif %}


            {% if entityStructure.extendedBy is not empty %}
                <br>
                extendedBy:<br>
                <ul>
                {% for extension in entityStructure.extendedBy %}
                    <li><a href="/mimoto.cms/entity/{{ extension.id }}/view"><span mls_id="entity.{{ extension.id }}.name">{{ extension.name }}</span></a></li>
                {% endfor %}
                </ul>
            {% endif %}

            {% if entityStructure.hasTable %}
                This entity has {{ entityStructure.instanceCount }} {% if entityStructure.instanceCount == 1 %}instance{% else %}instances{% endif %}
            {% else %}
                This entity has no table and is only used for extension purposes
            {% endif %}



            <br>
            <br>
            <br>
            #todo<br>
            // 1. show inherited properties<br>
            // 2. add checkbox<br>
            // 3. add dropdown with other entities<br>
            // 4. tab-module<br>
            // 5. visual representation<br>
            // 6. number of entities of this type (stats)<br>
            // 7. used in x connections (stats)<br>
            // 8. properties op aparte pagina<br>
            // 9. edit meta data op aparte pagina<br>
        </div>
        <div class="MimotoCMS_pages_entities_EntityDetail__meta_menu">
            {% include 'MimotoCMS/components/forms/input/Button/Button.twig' with { label:'Edit', icon:'', onclick:"Mimoto.CMS.entityEdit('" ~ Aimless.meta('id') ~ "');", type:'secondary' } %}<br>
        </div>

    </div>

    tabs | action: state-permission -> onCreate (voor welke groep?)<br>


    <div class="MimotoCMS_pages_entities_EntityDetail__properties">
        <br>
        Properties:<br>
        <br>
        {% include 'MimotoCMS/components/forms/input/Button/Button.twig' with { label:'Add new property', icon:'+', onclick:"Mimoto.CMS.entityPropertyNew('" ~ Aimless.meta('id') ~ "');" } %}
        <br>
        <br>
        <div class="MimotoCMS_pages_entities_EntityDetail__container" {{ Aimless.realtime('properties')|raw }}>
            {{ Aimless.data('properties')|raw }}
        </div>
    </div>

    <br>
    <hr>
    <br>
    <b>Danger zone!</b><br>
    <i><u>WARNING</u> - Deleting the entity will result in the LOSS OF ALL DATA related to this entity.</i><br>
    <br>
    {% include 'MimotoCMS/components/forms/input/Button/Button.twig' with { label:'Delete entity', icon:'X', onclick:"Mimoto.CMS.entityDelete(" ~ Aimless.meta('id') ~ ", '" ~ Aimless.data('name') ~ "');", type:'alert' } %}

{% endblock %}
