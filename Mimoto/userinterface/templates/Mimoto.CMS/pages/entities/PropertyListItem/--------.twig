{% include 'Mimoto.CMS/forms/output/title.twig' with
    {
        title:'Add a property',
        subtitle:'',
        description:'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.'
    }
%}


{% include 'Mimoto.CMS/forms/output/group_start.twig' %}

    {% include 'Mimoto.CMS/forms/input/textline.twig' with
        {
            label:'Name',
            name:'name',
            value:entity.name,
            validation:aPropertyNameValidation
        }
    %}

{% include 'Mimoto.CMS/forms/output/group_end.twig' %}




{% include 'Mimoto.CMS/forms/input/textline.twig' with { label:'Property name (id = '~property.id~')', name:'property_'~property.id~'_name', value:property.name, validation:aPropertyNameValidation } %}
{% include 'Mimoto.CMS/forms/input/textline.twig' with { label:'Part of group', name:'property_'~property.id~'_group', value:property.partofgroup, optional:true, validation:aPropertyGroupValidation } %}
{% include 'Mimoto.CMS/forms/input/dropdown.twig' with { label:'Property type', name:'property_'~property.id~'_type', value:property.type, aOptions:aPropertyTypes, onChange:'Mimoto.entity.property.showPropertyOptions('~property.id~');' } %}

<div id="options_value_{{ property.id }}" class="{% if property.type!='value' %}hidden{% endif %}">
    {% include 'Mimoto.CMS/forms/input/dropdown.twig' with { label:'Property option: type', name:'property_'~property.id~'_option_type', value:property.type, aOptions:aValueTypes } %}
</div>
<div id="options_entity_{{ property.id }}" class="{% if property.type!='entity' %}hidden{% endif %}">
    {% include 'Mimoto.CMS/forms/input/dropdown.twig' with { label:'Property option: entityType', name:'property_'~property.id~'_option_entitytype', value:property.type, aOptions:aAvailableEntities } %}
</div>
<div id="options_collection_{{ property.id }}" class="{% if property.type!='collection' %}hidden{% endif %}">
    {% include 'Mimoto.CMS/forms/input/dropdown.twig' with { label:'Property option: allowedEntityType', name:'property_'~property.id~'_option_allowedentitytype', value:property.type, aOptions:aAvailableEntities } %}
    {% include 'Mimoto.CMS/forms/input/dropdown.twig' with { label:'Property option: allowDuplicates', name:'property_'~property.id~'_option_allowduplicates', value:property.type, aOptions:aAllowDuplicatesOptions } %}
</div>



<script>

    // init
    if (typeof Mimoto == "undefined") Mimoto = {};

    Mimoto.entity = {};
    Mimoto.entity.property = {};
    Mimoto.entity.property.showPropertyOptions = function(nPropertyId)
    {

        var sPropertyType = document.getElementById('formdata_property_' + nPropertyId + '_type').value;

        switch(sPropertyType)
        {
            case 'value':

                $('#options_value_' + nPropertyId).removeClass('hidden');
                $('#options_entity_' + nPropertyId).addClass('hidden');
                $('#options_collection_' + nPropertyId).addClass('hidden');
                break;

            case 'entity':

                $('#options_value_' + nPropertyId).addClass('hidden');
                $('#options_entity_' + nPropertyId).removeClass('hidden');
                $('#options_collection_' + nPropertyId).addClass('hidden');
                break;

            case 'collection':

                $('#options_value_' + nPropertyId).addClass('hidden');
                $('#options_entity_' + nPropertyId).addClass('hidden');
                $('#options_collection_' + nPropertyId).removeClass('hidden');
                break;
        }

    }
</script>